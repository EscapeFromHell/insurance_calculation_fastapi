# Insurance Calculation FastAPI
REST API сервис по расчёту стоимости страхования в зависимости от типа груза и объявленной стоимости.

## Технологии
Python, FastAPI, Pydantic, Tortoise ORM, Aerich, PostgreSQL, Docker

## Запуск проекта
- Скачайте проект: 

```git clone https://github.com/EscapeFromHell/insurance_calculation_fastapi.git```

- После скачивания проекта, перейдите в папку проекта:

```cd insurance_calculation_fastapi```

- Выполните команду:

```docker compose up -d --build```

- После запуска контейнеров, проект будет доступен по ссылке: 

```http://127.0.0.1:8000/docs```

## Эндпоинты

1. ```POST /api_v1/rates/upload_json``` Загрузка тарифов из JSON файла: 

- Принимает на вход JSON файл с тарифами.
- Создаёт в базе данных тарифы.
- Если в БД уже есть тариф с указаной датой и типом груза, он будет удален и заменен на новый.

2. ```POST /api_v1/rates/upload_insurance_rates``` Загрузка тарифов:

- Принимает на вход запросы, формата:

```
{
  "2020-06-01": [
    {
      "cargo_type": "Glass",
      "rate": "0.04"
    },
    {
      "cargo_type": "Other",
      "rate": 0.01
    }
  ],
  "2020-07-01": [
    {
      "cargo_type": "Glass",
      "rate": "0.035"
    },
    {
      "cargo_type": "Other",
      "rate": 0.015
    }
  ]
}
```

- Создаёт в базе данных тарифы.
- Если в БД уже есть тариф с указаной датой и типом груза, он будет удален и заменен на новый.

3. ```GET /api_v1/rates/get_price``` Расчет стоимости страхования:
- Расчитывает стоимость, исходя из актуального тарифа, типа груза и заявленной стоимости.
